
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome to tornado_contrib’s documentation! &#8212; tornado_contrib 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-tornado-contrib-s-documentation">
<h1>Welcome to tornado_contrib’s documentation!<a class="headerlink" href="#welcome-to-tornado-contrib-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>
<div class="section" id="user-s-guide">
<h1>User’s Guide<a class="headerlink" href="#user-s-guide" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Introduction</p></li>
<li><p>Installation</p></li>
<li><p>Quickstart</p></li>
</ul>
</div>
<div class="section" id="criando-o-model">
<h1>Criando o Model<a class="headerlink" href="#criando-o-model" title="Permalink to this headline">¶</a></h1>
<dl class="simple">
<dt>Para criar um model utilize a classe MotorModel.</dt><dd><ul class="simple">
<li><p>Todos os models tem como base de herança o <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">schematics.modes.Model</a>.</p></li>
<li><p>Cada attributo constitui de um campo no banco de dados.</p></li>
<li><p>A classe interna <strong>Meta</strong> informa qual collection este modelo pertence.</p></li>
</ul>
</dd>
</dl>
<div class="section" id="quick-example">
<h2>Quick Example<a class="headerlink" href="#quick-example" title="Permalink to this headline">¶</a></h2>
<p>O código abaixo mostra um exemplo de modelo utilizando o <strong>MotorModel</strong>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">contrib.base.models</span> <span class="kn">import</span> <span class="n">MotorModel</span>

<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">MotorModel</span><span class="p">):</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">StringType</span><span class="p">()</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">StringType</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="s1">&#39;persons&#39;</span>
</pre></div>
</div>
<p><strong>first_name</strong> e <strong>last_name</strong> são campos do modelo, já a classe interna <strong>Meta</strong> é responsável por informar
qual collection do banco de dados será preenchida com os dados do modelo.</p>
<p>O modelo <strong>Person</strong> acima criará um documento da forma abaixo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="fields">
<h2>Fields<a class="headerlink" href="#fields" title="Permalink to this headline">¶</a></h2>
<p>Os campos utilizam as classes que herdam de <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">schematics.models.BaseType</a>.
Tome cautela para não criar campos que conflitam com o nome do objeto <strong>manager</strong> do Model.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">contrib.base.models</span> <span class="kn">import</span> <span class="n">MotorModel</span>
<span class="kn">from</span> <span class="nn">contrib.base</span> <span class="kn">import</span> <span class="n">fields</span>

<span class="k">class</span> <span class="nc">Musician</span><span class="p">(</span><span class="n">MotorModel</span><span class="p">):</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ObjectId</span><span class="p">()</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringType</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringType</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">instrument</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringType</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntType</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Album</span><span class="p">(</span><span class="n">MotorModel</span><span class="p">):</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ObjectId</span><span class="p">()</span>
    <span class="n">artist</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ModelType</span><span class="p">(</span><span class="n">Musician</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringType</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">release_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateType</span><span class="p">()</span>
    <span class="n">num_stars</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntegerType</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="fields-types">
<h2>Fields Types<a class="headerlink" href="#fields-types" title="Permalink to this headline">¶</a></h2>
<p>Cada campo no modelo deve ser uma instância de <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">schematics.models.BaseType</a>.
Para mais detalhes sobre os tipos de campos e seus argumentos visite <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/types.html">Types</a>.</p>
</div>
<div class="section" id="relationships">
<h2>Relationships<a class="headerlink" href="#relationships" title="Permalink to this headline">¶</a></h2>
<div class="section" id="many-to-one-relationships">
<h3>Many-to-one relationships<a class="headerlink" href="#many-to-one-relationships" title="Permalink to this headline">¶</a></h3>
<p>Para definir uma relação de many-to-one utilize o campo <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">schematics.models.ModelType</a>.</p>
<p>Este campo precisa de um <strong>MotorModel</strong> como argumento obrigatório para fazer o relacionamento.</p>
<p>Por exemplo, se um <strong>Order</strong> tem um <strong>User</strong>, quer dizer que um usuário pode fazer vários
pedidos mas cada pedido só pode ter um <strong>User</strong>, verifique o exemplo abaixo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">contrib.base.models</span> <span class="kn">import</span> <span class="n">MotorModel</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">MotorModel</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringType</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Order</span><span class="p">(</span><span class="n">MotorModel</span><span class="p">):</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntegerType</span><span class="p">()</span>
<span class="hll">    <span class="n">user</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ModelType</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
</span></pre></div>
</div>
<p>O doumento <strong>Order</strong> ficará dessa forma:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">},</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">1200</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="many-to-many-relationships">
<h3>Many-to-many relationships<a class="headerlink" href="#many-to-many-relationships" title="Permalink to this headline">¶</a></h3>
<p>Para definir relações many-to-many é necessário fazer a junção de dois campos. No MongoDB relações
many-to-many são constituidos de listas de documentos.</p>
<p>Por exemplo, se uma <strong>Pizza</strong> contém multiplos documentos <strong>Topping</strong>, assim um documento <strong>Topping</strong>
pode está em diversas pizzas e cada <strong>Pizza</strong> pode conter diversos <strong>Topping</strong>, abaixo mostra como
representamos isso:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">contrib.base.models</span> <span class="kn">import</span> <span class="n">MotorModel</span>
<span class="kn">from</span> <span class="nn">contrib.base</span> <span class="kn">import</span> <span class="n">fields</span>

<span class="k">class</span> <span class="nc">Topping</span><span class="p">(</span><span class="n">MotorModel</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringType</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Pizza</span><span class="p">(</span><span class="n">MotorModel</span><span class="p">):</span>
    <span class="n">toppings</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ListType</span><span class="p">(</span><span class="n">ModelType</span><span class="p">(</span><span class="n">Topping</span><span class="p">))</span>
</pre></div>
</div>
<p>O resultado desse relacionamento criará um documento dessa forma:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;pizza&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Hot sauce&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Tomato sauce&quot;</span><span class="p">}]}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="classe-interna-meta">
<h2>Classe interna <strong>Meta</strong><a class="headerlink" href="#classe-interna-meta" title="Permalink to this headline">¶</a></h2>
<p>Esta classe é obrigatória no momento da construção do model, pois adiciona metadados para que
se possa definir qual collection o model irá lidar. O campo <strong>collection_name</strong> é responsável
por informar a descrição da collection do model no banco de dados MongodBD.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">contrib.base.models</span> <span class="kn">import</span> <span class="n">MotorModel</span>
<span class="kn">from</span> <span class="nn">contrib.base</span> <span class="kn">import</span> <span class="n">fields</span>

<span class="k">class</span> <span class="nc">Car</span><span class="p">(</span><span class="n">MotorModel</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringType</span><span class="p">()</span>

<span class="hll">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span class="hll">        <span class="n">collection_name</span> <span class="o">=</span> <span class="s1">&#39;cars&#39;</span>
</span></pre></div>
</div>
</div>
<div class="section" id="attributos-do-model">
<h2>Attributos do <strong>Model</strong><a class="headerlink" href="#attributos-do-model" title="Permalink to this headline">¶</a></h2>
<div class="section" id="manager">
<h3><strong>manager</strong><a class="headerlink" href="#manager" title="Permalink to this headline">¶</a></h3>
<p>O atributo mais importante do model é o <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">ModelManager</a>. O manager é uma interface responsável
por fazer as operações de banco de dados.</p>
</div>
<div class="section" id="collection">
<h3><strong>collection</strong><a class="headerlink" href="#collection" title="Permalink to this headline">¶</a></h3>
<p>Um objeto <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">MotorCollection</a>.</p>
</div>
</div>
<div class="section" id="parametros-do-model">
<h2>Parâmetros do <strong>Model</strong><a class="headerlink" href="#parametros-do-model" title="Permalink to this headline">¶</a></h2>
<p>O model necessita como parâmetro obrigatório uma instância de um <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">MotorDatabase</a> para que
seja possível a comunicação com o banco de dados.</p>
<p>Como geralmente os models são utilizados dentro de handlers, de acordo com a utilização
do Motor com o Tornado, faça da seguinte forma:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Car</span><span class="p">(</span><span class="n">MotorModel</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringType</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">collection_name</span> <span class="o">=</span> <span class="s1">&#39;cars&#39;</span>

<span class="k">class</span> <span class="nc">CarsHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">        <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span>
</span><span class="hll">        <span class="n">model</span> <span class="o">=</span> <span class="n">Car</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</div>
<div class="section" id="criando-o-modelapiview">
<h1>Criando o ModelAPIView<a class="headerlink" href="#criando-o-modelapiview" title="Permalink to this headline">¶</a></h1>
<p>Esta biblioteca possibilita a criação de API’s REST baseados em classes, utilizando modelos definidos
com a classe <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">MotorModel</a>.</p>
<p>Todas os handlers, herdam da classe <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">ModelAPIView</a>, todas as requisições são roteadas
para os seus respectivos métodos, por exemplo, uma requisição do tipo POST, será roteada para o método
<strong>.post()</strong>.</p>
<p>Os handlers <a class="reference external" href="https://schematics.readthedocs.io/en/latest/usage/models.html">ModelAPIView</a> recebem um importante attributo denomidado <strong>model</strong>.</p>
<p>Por exemplo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">contrib.handlers</span> <span class="kn">import</span> <span class="n">ModelAPIView</span>

<span class="k">class</span> <span class="nc">PersonAPIHandler</span><span class="p">(</span><span class="n">ModelAPIView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Person</span>
</pre></div>
</div>
<p>O ModelAPIView já implementa todos os métodos de uma API REST, tornando muito mais rápido e fácil
criar endpoints de um modelo.
Para customizar algum método por exemplo, o método de listagem, faça o seguinte:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">contrib.handlers</span> <span class="kn">import</span> <span class="n">ModelAPIView</span>

<span class="k">class</span> <span class="nc">PersonAPIHandler</span><span class="p">(</span><span class="n">ModelAPIView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Person</span>

    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_response</span><span class="p">(</span><span class="n">queryset</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paginate_response</span><span class="p">(</span><span class="n">queryset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
<div class="section" id="attributos-do-modelapiview">
<h2>Attributos do ModelAPIView<a class="headerlink" href="#attributos-do-modelapiview" title="Permalink to this headline">¶</a></h2>
<p>A</p>
</div>
<div class="section" id="metodos-do-modelapiview">
<h2>Métodos do ModelAPIView<a class="headerlink" href="#metodos-do-modelapiview" title="Permalink to this headline">¶</a></h2>
<p>A</p>
</div>
</div>
<div class="section" id="utilizando-com-tornado">
<h1>Utilizando com Tornado<a class="headerlink" href="#utilizando-com-tornado" title="Permalink to this headline">¶</a></h1>
<p><strong>pass</strong></p>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">tornado_contrib</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Luiz Rodrigo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>